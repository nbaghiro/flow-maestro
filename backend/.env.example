# FlowMaestro Backend Environment Configuration
# ===========================================
#
# QUICK START FOR NEW DEVELOPERS:
# 1. Run: ../infra/scripts/sync-secrets-local.sh
#    (This pulls all secrets from GCP Secret Manager and creates backend/.env automatically)
# 2. Start infrastructure: npm run docker:up (from project root)
# 3. Run migrations: npm run db:migrate (from project root)
# 4. Start dev servers: npm run dev (from project root)
#
# NOTE: You should NOT manually copy this file. Instead, use the sync-secrets-local.sh
# script which automatically fetches all values from GCP Secret Manager and creates
# backend/.env for you.
#
# WARNING: backend/.env contains sensitive information and is already in .gitignore.
# NEVER commit .env files to git!

# ==============================================================================
# Core Application
# ==============================================================================
NODE_ENV=development
LOG_LEVEL=debug

# ==============================================================================
# Database Configuration
# ==============================================================================
# These are auto-populated by sync-secrets-local.sh from GCP Secret Manager
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=flowmaestro
POSTGRES_USER=flowmaestro
POSTGRES_PASSWORD=flowmaestro_dev_password

# Connection string (constructed automatically by sync script)
DATABASE_URL=postgresql://flowmaestro:flowmaestro_dev_password@localhost:5432/flowmaestro

# ==============================================================================
# Redis Configuration
# ==============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_URL=redis://localhost:6379

# ==============================================================================
# Security Secrets
# ==============================================================================
# JWT Secret for authentication tokens
# Auto-generated by sync-secrets-local.sh or manually generate with:
# openssl rand -base64 64 | tr -d "=+/" | cut -c1-64
JWT_SECRET=dev-jwt-secret-change-in-production

# Encryption Key for credentials storage
# MUST be 64 hex characters (32 bytes)
# Auto-generated by sync-secrets-local.sh or manually generate with:
# openssl rand -hex 32
ENCRYPTION_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef

# ==============================================================================
# LLM API Keys
# ==============================================================================
# These are optional for basic development but required for AI features
# Sync from Secret Manager with: ./infra/scripts/sync-secrets-local.sh
OPENAI_API_KEY=
ANTHROPIC_API_KEY=
GOOGLE_API_KEY=

# ==============================================================================
# OAuth Integration Secrets
# ==============================================================================
# Required for testing OAuth integrations with external services
# Sync from Secret Manager with: ./infra/scripts/sync-secrets-local.sh

# Slack
SLACK_CLIENT_ID=
SLACK_CLIENT_SECRET=

# Google (used for Sheets, Drive, Calendar, Gmail, and user authentication)
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=

# Notion
NOTION_CLIENT_ID=
NOTION_CLIENT_SECRET=

# Airtable
AIRTABLE_CLIENT_ID=
AIRTABLE_CLIENT_SECRET=

# HubSpot
HUBSPOT_CLIENT_ID=
HUBSPOT_CLIENT_SECRET=

# GitHub
GITHUB_CLIENT_ID=
GITHUB_CLIENT_SECRET=

# Linear
LINEAR_CLIENT_ID=
LINEAR_CLIENT_SECRET=

# Figma
FIGMA_CLIENT_ID=
FIGMA_CLIENT_SECRET=

# Meta Platform (WhatsApp, Instagram, Messenger, Facebook Ads)
# Create a Meta App at https://developers.facebook.com/apps/
META_APP_ID=
META_APP_SECRET=
# Optional: WhatsApp Embedded Signup configuration ID
META_WHATSAPP_CONFIG_ID=
# Webhook verification token (you set this value, then configure the same in Meta dashboard)
META_WEBHOOK_VERIFY_TOKEN=

# ==============================================================================
# Temporal Configuration
# ==============================================================================
TEMPORAL_ADDRESS=localhost:7233
TEMPORAL_NAMESPACE=default

# Temporal Database (for self-hosted Temporal)
# Usually same as main database for local development
TEMPORAL_DB_HOST=localhost
TEMPORAL_DB_PORT=5432
TEMPORAL_DB_NAME=flowmaestro_temporal
TEMPORAL_DB_USER=flowmaestro
TEMPORAL_DB_PASSWORD=flowmaestro_dev_password
TEMPORAL_VISIBILITY_DB=flowmaestro_temporal_visibility

# ==============================================================================
# Backend API Configuration
# ==============================================================================
BACKEND_PORT=3001
BACKEND_HOST=localhost
PORT=3001
API_URL=http://localhost:3001
CORS_ORIGIN=http://localhost:3000

# ==============================================================================
# Frontend Configuration
# ==============================================================================
VITE_API_URL=http://localhost:3001
VITE_WS_URL=http://localhost:3001

# ==============================================================================
# Google Cloud Storage (for Knowledge Base documents)
# ==============================================================================
# Required for knowledge base document storage features
GCS_BUCKET_NAME=
# Optional: Signed URL expiration time in seconds (default: 3600 = 1 hour)
GCS_SIGNED_URL_EXPIRATION=3600

# ==============================================================================
# Secrets Management Helper Scripts
# ==============================================================================
#
# PULL SECRETS FROM GCP (Recommended for local development):
#   ./infra/scripts/sync-secrets-local.sh
#   - Pulls all secrets from GCP Secret Manager
#   - Uses your current gcloud default project
#   - Generates this .env file automatically
#   - Also creates backend/.env for convenience
#
# PUSH SECRETS TO GCP (For initial setup or updates):
#   ./infra/scripts/setup-secrets-gcp.sh
#   - Interactive script to create/update secrets in GCP Secret Manager
#   - Auto-generates secure values for JWT and encryption keys
#   - Uses your current gcloud default project
#
# Prerequisites:
#   - gcloud CLI installed and authenticated
#   - Appropriate permissions on the GCP project
#
